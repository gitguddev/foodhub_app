(this.webpackJsonpfoodhub=this.webpackJsonpfoodhub||[]).push([[21],{259:function(e,n,t){"use strict";t.r(n);var a=t(26),r=t.n(a),l=t(37),c=t(24),o=t(28),i=t(33),u=t(0),s=t.n(u),d=t(17),m=t(3),f=t(25),b=t(90),p=t(36),h=t(34),g=t(88),E=t.n(g),v=t(142),w=t.n(v),x=t(86),y=t(260),j=t.n(y),k=t(87);function O(){var e=Object(i.a)(["\n  background-color: ",";\n  color: black;\n  padding: 4px 9px;\n  border-radius: 4px;\n  margin: 0px 10px 10px 0px;\n  align-self: flex-start;\n  transition: all 0.1s;\n\n  svg {\n    color: #555;\n  }\n\n  &:hover {\n    ","\n  }\n"]);return O=function(){return e},e}function _(){var e=Object(i.a)(["\n  display: flex;\n  & > * {\n    margin: 5px;\n  }\n"]);return _=function(){return e},e}function C(){var e=Object(i.a)(["\n  border: none;\n  border-radius: 3px;\n  background-color: ",";\n  color: white;\n  padding: 5px 13px;\n  transition: all 0.3s;\n\n  &:hover {\n    background-color: ",";\n    transition: all 0.3s;\n  }\n"]);return C=function(){return e},e}function F(){var e=Object(i.a)(["\n  display: grid;\n  grid-template-columns: 1fr 1fr 1fr;\n  grid-auto-rows: min-content;\n  font-size: 0.8em;\n\n  margin-top: 20px;\n  width: 100%;\n  z-index: 1;\n  text-align: center;\n\n  span:nth-child(1),\n  span:nth-child(2),\n  span:nth-child(3) {\n    text-align: center !important;\n    font-weight: bold;\n  }\n"]);return F=function(){return e},e}function z(){var e=Object(i.a)(["\n  height: ","px;\n  width: ","px;\n  margin: 15px 0;\n  overflow: auto;\n  display: flex;\n  flex-direction: column;\n  padding: 3px;\n  align-items: center;\n  font-size: calc(0.5vw + 0.5vh + 7px);\n  background-color: white;\n  color: black;\n  border-radius: 4px;\n"]);return z=function(){return e},e}function S(){var e=Object(i.a)(["\n  background-color: #232323;\n  color: white;\n  padding: 15px;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]);return S=function(){return e},e}function R(){var e=Object(i.a)(["\n  th {\n    background-color: #232323;\n    color: white;\n    width: calc(100% / 4);\n  }\n  td {\n    border-bottom: 1px solid #232323;\n  }\n  td,\n  th {\n    padding: 10px;\n    text-align: center;\n  }\n  font-size: 0.8em;\n  border-collapse: collapse;\n  .info + tr {\n    overflow: hidden;\n    font-size: 0;\n    transition: all 0.3s;\n    background-color: #eee;\n  }\n  .info:hover {\n    background-color: #666;\n    color: white;\n    cursor: pointer;\n  }\n  .info:hover + tr {\n    transition: all 0.2s;\n    font-size: 0.8em;\n    background-color: #fff !important;\n  }\n\n  .viewed {\n    font-size: 1em !important;\n    background-color: #fff !important;\n  }\n"]);return R=function(){return e},e}var D=["\u0e21\u0e01\u0e23\u0e32\u0e04\u0e21","\u0e01\u0e38\u0e21\u0e20\u0e32\u0e1e\u0e31\u0e19\u0e18\u0e4c","\u0e21\u0e35\u0e19\u0e32\u0e04\u0e21","\u0e40\u0e21\u0e29\u0e32\u0e22\u0e19","\u0e1e\u0e24\u0e29\u0e20\u0e32\u0e04\u0e21","\u0e21\u0e34\u0e16\u0e38\u0e19\u0e32\u0e22\u0e19","\u0e01\u0e23\u0e01\u0e0f\u0e32\u0e04\u0e21","\u0e2a\u0e34\u0e07\u0e2b\u0e32\u0e04\u0e21","\u0e01\u0e31\u0e19\u0e22\u0e32\u0e22\u0e19","\u0e15\u0e38\u0e25\u0e32\u0e04\u0e21","\u0e1e\u0e24\u0e28\u0e08\u0e34\u0e01\u0e32\u0e22\u0e19","\u0e18\u0e31\u0e19\u0e27\u0e32\u0e04\u0e21"],U=h.a.table(R()),q=h.a.div(S()),I=h.a.div(z(),(function(e){return e.height}),(function(e){return e.width})),J=h.a.div(F()),N=h.a.button(C(),(function(e){return e.blue?"blue":"green"}),(function(e){return e.blue?"#000080":"#002e00"})),Y=h.a.div(_()),A=h.a.button(O(),(function(e){return e.disabled?"grey":"white"}),(function(e){return!e.disabled&&"\n    background-color: #ccc;\n    cursor: pointer;\n    transition: all 0.1s;\n  "}));function B(e){var n,t,a=e.sessions_id,r=(e.table_number,Object(m.h)().restaurant_id),l=Object(d.a)({promiseFn:f.b,url:"/manager/bill/get.php?restaurant_id=".concat(r,"&user_uid=").concat(b.a.currentUser.uid,"&sessions_id=").concat(a)}),c=l.data,o=l.error,i=Object(u.useRef)(null);return o||("success"===(null===c||void 0===c?void 0:c.message)?(window.screen.width>window.screen.height?n=1.4124*(t=window.screen.height/100*80)-t:t=1.4142*(n=window.screen.width/100*80),s.a.createElement(q,null,s.a.createElement(H,{billRef:i,width:n,data:c.result}),s.a.createElement(Y,null,s.a.createElement("a",{onClick:function(){i.current.style.overflow="visible",w()(i.current,{height:i.current.scrollHeight,backgroundColor:"#fff"}).then((function(e){window.location.href=e.toDataURL().replace("image/png","image/octet-stream"),i.current.style.overflow="auto"}))}},s.a.createElement(N,{blue:!0},s.a.createElement(x.a,{icon:k.s})," \u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01"))))):s.a.createElement(p.a,null))}function H(e){var n=e.billRef,t=e.width,a=e.height,r=e.data,l=[s.a.createElement(u.Fragment,{key:"head"},s.a.createElement("span",null,"\u0e0a\u0e37\u0e48\u0e2d\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"),s.a.createElement("span",null,"\u0e08\u0e33\u0e19\u0e27\u0e19"),s.a.createElement("span",null,"\u0e23\u0e27\u0e21"))].concat(Object(o.a)(r.map((function(e){var n=e.name,t=e.quantity,a=e.total;return s.a.createElement(u.Fragment,{key:e.sessions_id},s.a.createElement("span",null,n),s.a.createElement("span",null,t),s.a.createElement("span",null,a))}))));function c(e){var n=e.data,t=n.year,a=n.month,r=n.day;return s.a.createElement("span",null,r," ",D[a]," ",parseInt(t)+543)}return s.a.createElement(I,{ref:n,width:t,height:a},s.a.createElement("span",null,s.a.createElement("u",null,s.a.createElement("big",null,s.a.createElement("big",null,r[0].restaurant_name)))),s.a.createElement("small",{style:{marginBottom:8}},"\u0e42\u0e15\u0e4a\u0e30\u0e17\u0e35\u0e48 ",r[0].table_number),s.a.createElement("small",null,"\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48 ",s.a.createElement(c,{data:r[0]})),s.a.createElement("small",null,"\u0e17\u0e31\u0e49\u0e07\u0e2b\u0e21\u0e14 ",r.length," \u0e23\u0e32\u0e22\u0e01\u0e32\u0e23"),s.a.createElement(J,null,l),s.a.createElement("span",{style:{marginTop:25}},"\u0e23\u0e27\u0e21\u0e17\u0e31\u0e49\u0e07\u0e2a\u0e34\u0e49\u0e19"," ",E()(r.reduce((function(e,n){return e+parseFloat(n.total)}),0)).format("0,0.00")," ","\u0e1a\u0e32\u0e17"))}function L(e){var n=e.filter,t=e.year,a=Object(m.h)().restaurant_id,o=Object(u.useState)(),i=Object(c.a)(o,2),d=i[0],p=i[1],h=Object(u.useRef)();return Object(u.useEffect)((function(){var e;function c(){return(c=Object(l.a)(r.a.mark((function l(){var c,o,i,u;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(f.b)({url:"/manager/report/chart.php?restaurant_id=".concat(a,"&user_uid=").concat(b.a.currentUser.uid,"&filter=").concat(n,"&year=").concat(t)});case 2:"success"===(c=r.sent).message&&(o=[],i=[],u="income"===n?[{label:"\u0e23\u0e32\u0e22\u0e23\u0e31\u0e1a",data:o,backgroundColor:"#500"},{label:"\u0e01\u0e33\u0e44\u0e23 (\u0e2b\u0e31\u0e01\u0e15\u0e49\u0e19\u0e17\u0e38\u0e19)",data:i,backgroundColor:"#777"}]:[{label:"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e1a\u0e23\u0e34\u0e01\u0e32\u0e23",data:o,backgroundColor:"#500"}],c.result.forEach((function(e){o[e.month]=e.total,e.cost&&(i[e.month]=e.cost)})),e=new j.a(h.current,{type:"bar",options:{responsive:!0,maintainAspectRatio:!1},data:{labels:D,datasets:u}}),p(e));case 4:case"end":return r.stop()}}),l)})))).apply(this,arguments)}d&&d.destroy(),function(){c.apply(this,arguments)}()}),[n,a,t]),s.a.createElement("div",{style:{position:"relative"}},s.a.createElement("canvas",{height:400,ref:h,id:"chart"}))}n.default=function(){var e,n,t=Object(m.h)().restaurant_id,a=Object(u.useState)(0),r=Object(c.a)(a,2),l=r[0],o=r[1],i=Object(u.useState)((new Date).getFullYear()),h=Object(c.a)(i,2),g=h[0],v=h[1],w=Object(u.useState)("income"),y=Object(c.a)(w,2),j=y[0],O=y[1],_=Object(d.a)({promiseFn:f.b,url:"/manager/report/get.php?restaurant_id=".concat(t,"&user_uid=").concat(b.a.currentUser.uid,"&page=").concat(l)}),C=_.data,F=_.error,z=_.reload,S=_.setData,R=_.cancel,D=Object(u.useState)(null),q=Object(c.a)(D,2),I=q[0],J=q[1];function N(e){o(l+e<=0?0:l+e)}function Y(){var e;if(!((null===(e=C.result)||void 0===e?void 0:e.length)>1))return 0;var n=C.result[0].total_sessions;return Math.ceil(n/5)}return Object(u.useEffect)((function(){return S({message:"loading"},z),R}),[R,l,z,t,S]),F||("success"===(null===C||void 0===C?void 0:C.message)?(null===(e=C.result)||void 0===e?void 0:e.length)>0?s.a.createElement(s.a.Fragment,null,s.a.createElement("small",null,s.a.createElement(x.a,{style:{color:"#555"},icon:k.d})," \u0e01\u0e23\u0e32\u0e1f\u0e23\u0e32\u0e22\u0e07\u0e32\u0e19\u0e1b\u0e23\u0e30\u0e08\u0e33\u0e1b\u0e35"," ",s.a.createElement("select",{onChange:function(e){v(e.target.value)},value:(new Date).getFullYear()+543},C.result[0].year.split(",").filter((function(e,n,t){return n!==t.length-1})).map((function(e,n){return s.a.createElement("option",{key:e,value:e},parseInt(e)+543)}))),s.a.createElement("small",null,s.a.createElement("form",{onChange:function(e){O(e.target.value)}},s.a.createElement("label",null,s.a.createElement("input",{defaultChecked:!0,type:"radio",name:"filter",value:"income"})," ","\u0e22\u0e2d\u0e14\u0e23\u0e32\u0e22\u0e44\u0e14\u0e49"),s.a.createElement("label",null,s.a.createElement("input",{type:"radio",name:"filter",value:"quantity"})," ","\u0e08\u0e33\u0e19\u0e27\u0e19\u0e01\u0e32\u0e23\u0e43\u0e0a\u0e49\u0e1a\u0e23\u0e34\u0e01\u0e32\u0e23")))),s.a.createElement(L,{filter:j,year:g}),s.a.createElement("br",null),s.a.createElement("small",null,s.a.createElement(x.a,{style:{color:"#555"},icon:k.i})," \u0e1b\u0e23\u0e30\u0e27\u0e31\u0e15\u0e34\u0e01\u0e32\u0e23\u0e0a\u0e33\u0e23\u0e30"," ",s.a.createElement("small",null,"\u0e2b\u0e19\u0e49\u0e32 ",l+1," \u0e08\u0e32\u0e01 ",Y()),s.a.createElement("br",null),s.a.createElement(A,{disabled:l<=0,onClick:function(){return N(-1)}},s.a.createElement(x.a,{icon:k.a})," \u0e22\u0e49\u0e2d\u0e19\u0e01\u0e25\u0e31\u0e1a"),s.a.createElement(A,{disabled:l+1>=Y(),onClick:function(){return N(1)}},s.a.createElement(x.a,{icon:k.j})," \u0e16\u0e31\u0e14\u0e44\u0e1b")),s.a.createElement(U,null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"\u0e2b\u0e21\u0e32\u0e22\u0e40\u0e25\u0e02\u0e40\u0e0b\u0e2a\u0e0a\u0e31\u0e48\u0e19"),s.a.createElement("th",null,"\u0e40\u0e25\u0e02\u0e17\u0e35\u0e48\u0e42\u0e15\u0e4a\u0e30"),s.a.createElement("th",null,"\u0e08\u0e33\u0e19\u0e27\u0e19\u0e2d\u0e32\u0e2b\u0e32\u0e23"),s.a.createElement("th",null,"\u0e23\u0e27\u0e21\u0e2a\u0e38\u0e17\u0e18\u0e34"))),s.a.createElement("tbody",null,(null===(n=C.result)||void 0===n?void 0:n.length)>0&&C.result.map((function(e){return s.a.createElement(u.Fragment,{key:e.id},s.a.createElement("tr",{className:"info",onClick:function(){return n=e.id,void J(I===n?null:n);var n}},s.a.createElement("td",null,e.id),s.a.createElement("td",null,e.table_number),s.a.createElement("td",null,e.quantity),s.a.createElement("td",null,E()(e.total).format("0,0.00"))),I===e.id?s.a.createElement("tr",{className:"viewed"},s.a.createElement("td",{colSpan:4},s.a.createElement(B,{table_number:e.table_number,sessions_id:e.id}))):s.a.createElement("tr",null,s.a.createElement("td",{colSpan:4},"\u0e15\u0e23\u0e27\u0e08\u0e2a\u0e2d\u0e1a\u0e43\u0e1a\u0e40\u0e2a\u0e23\u0e47\u0e08")))}))))):"\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e40\u0e04\u0e22\u0e21\u0e33\u0e01\u0e32\u0e23\u0e0a\u0e33\u0e23\u0e30\u0e40\u0e07\u0e34\u0e19\u0e20\u0e32\u0e22\u0e43\u0e19\u0e23\u0e49\u0e32\u0e19\u0e19\u0e35\u0e49 !":s.a.createElement(p.a,null))}}}]);
//# sourceMappingURL=21.d13c68f7.chunk.js.map